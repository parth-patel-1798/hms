var ce=t=>{throw TypeError(t)};var K=(t,e,s)=>e.has(t)||ce("Cannot "+s);var r=(t,e,s)=>(K(t,e,"read from private field"),s?s.call(t):e.get(t)),g=(t,e,s)=>e.has(t)?ce("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),d=(t,e,s,a)=>(K(t,e,"write to private field"),a?a.call(t,s):e.set(t,s),s),p=(t,e,s)=>(K(t,e,"access private method"),s);import{t as Re,v as N,w as W,x as _,y as je,z as he,A as ue,B as we,C as Ce,D as Ne,E as de,H as ge,r as j,I as Ee,J as Se,K as q,M as G,l as Oe,m as Fe,n as Ie,q as De,N as Qe,j as i,T as k,o as Pe,_ as fe,e as Te,f as Ue,i as Ae,k as Le,P as Me,O as Be}from"./index-CUnRofYz.js";var y,n,L,b,O,D,C,M,Q,P,F,I,E,T,o,A,J,X,Y,Z,ee,te,se,be,xe,_e=(xe=class extends Re{constructor(e,s){super();g(this,o);g(this,y);g(this,n);g(this,L);g(this,b);g(this,O);g(this,D);g(this,C);g(this,M);g(this,Q);g(this,P);g(this,F);g(this,I);g(this,E);g(this,T,new Set);this.options=s,d(this,y,e),d(this,C,null),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,n).addObserver(this),me(r(this,n),this.options)?p(this,o,A).call(this):this.updateResult(),p(this,o,Z).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return re(r(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return re(r(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,p(this,o,ee).call(this),p(this,o,te).call(this),r(this,n).removeObserver(this)}setOptions(e,s){const a=this.options,c=r(this,n);if(this.options=r(this,y).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof N(this.options.enabled,r(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");p(this,o,se).call(this),r(this,n).setOptions(this.options),a._defaulted&&!W(this.options,a)&&r(this,y).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,n),observer:this});const h=this.hasListeners();h&&pe(r(this,n),c,this.options,a)&&p(this,o,A).call(this),this.updateResult(s),h&&(r(this,n)!==c||N(this.options.enabled,r(this,n))!==N(a.enabled,r(this,n))||_(this.options.staleTime,r(this,n))!==_(a.staleTime,r(this,n)))&&p(this,o,J).call(this);const l=p(this,o,X).call(this);h&&(r(this,n)!==c||N(this.options.enabled,r(this,n))!==N(a.enabled,r(this,n))||l!==r(this,E))&&p(this,o,Y).call(this,l)}getOptimisticResult(e){const s=r(this,y).getQueryCache().build(r(this,y),e),a=this.createResult(s,e);return He(this,a)&&(d(this,b,a),d(this,D,this.options),d(this,O,r(this,n).state)),a}getCurrentResult(){return r(this,b)}trackResult(e,s){const a={};return Object.keys(e).forEach(c=>{Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(c),s==null||s(c),e[c])})}),a}trackProp(e){r(this,T).add(e)}getCurrentQuery(){return r(this,n)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,y).defaultQueryOptions(e),a=r(this,y).getQueryCache().build(r(this,y),s);return a.isFetchingOptimistic=!0,a.fetch().then(()=>this.createResult(a,s))}fetch(e){return p(this,o,A).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,b)))}createResult(e,s){var le;const a=r(this,n),c=this.options,h=r(this,b),l=r(this,O),f=r(this,D),x=e!==a?e.state:r(this,L),{state:w}=e;let u={...w},U=!1,v;if(s._optimisticResults){const R=this.hasListeners(),z=!R&&me(e,s),ve=R&&pe(e,a,s,c);(z||ve)&&(u={...u,...Ne(w.data,e.options)}),s._optimisticResults==="isRestoring"&&(u.fetchStatus="idle")}let{error:B,errorUpdatedAt:ae,status:S}=u;if(s.select&&u.data!==void 0)if(h&&u.data===(l==null?void 0:l.data)&&s.select===r(this,M))v=r(this,Q);else try{d(this,M,s.select),v=s.select(u.data),v=de(h==null?void 0:h.data,v,s),d(this,Q,v),d(this,C,null)}catch(R){d(this,C,R)}else v=u.data;if(s.placeholderData!==void 0&&v===void 0&&S==="pending"){let R;if(h!=null&&h.isPlaceholderData&&s.placeholderData===(f==null?void 0:f.placeholderData))R=h.data;else if(R=typeof s.placeholderData=="function"?s.placeholderData((le=r(this,P))==null?void 0:le.state.data,r(this,P)):s.placeholderData,s.select&&R!==void 0)try{R=s.select(R),d(this,C,null)}catch(z){d(this,C,z)}R!==void 0&&(S="success",v=de(h==null?void 0:h.data,R,s),U=!0)}r(this,C)&&(B=r(this,C),v=r(this,Q),ae=Date.now(),S="error");const H=u.fetchStatus==="fetching",V=S==="pending",$=S==="error",ne=V&&H,oe=v!==void 0;return{status:S,fetchStatus:u.fetchStatus,isPending:V,isSuccess:S==="success",isError:$,isInitialLoading:ne,isLoading:ne,data:v,dataUpdatedAt:u.dataUpdatedAt,error:B,errorUpdatedAt:ae,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>x.dataUpdateCount||u.errorUpdateCount>x.errorUpdateCount,isFetching:H,isRefetching:H&&!V,isLoadingError:$&&!oe,isPaused:u.fetchStatus==="paused",isPlaceholderData:U,isRefetchError:$&&oe,isStale:ie(e,s),refetch:this.refetch}}updateResult(e){const s=r(this,b),a=this.createResult(r(this,n),this.options);if(d(this,O,r(this,n).state),d(this,D,this.options),r(this,O).data!==void 0&&d(this,P,r(this,n)),W(a,s))return;d(this,b,a);const c={},h=()=>{if(!s)return!0;const{notifyOnChangeProps:l}=this.options,f=typeof l=="function"?l():l;if(f==="all"||!f&&!r(this,T).size)return!0;const m=new Set(f??r(this,T));return this.options.throwOnError&&m.add("error"),Object.keys(r(this,b)).some(x=>{const w=x;return r(this,b)[w]!==s[w]&&m.has(w)})};(e==null?void 0:e.listeners)!==!1&&h()&&(c.listeners=!0),p(this,o,be).call(this,{...c,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&p(this,o,Z).call(this)}},y=new WeakMap,n=new WeakMap,L=new WeakMap,b=new WeakMap,O=new WeakMap,D=new WeakMap,C=new WeakMap,M=new WeakMap,Q=new WeakMap,P=new WeakMap,F=new WeakMap,I=new WeakMap,E=new WeakMap,T=new WeakMap,o=new WeakSet,A=function(e){p(this,o,se).call(this);let s=r(this,n).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(je)),s},J=function(){p(this,o,ee).call(this);const e=_(this.options.staleTime,r(this,n));if(he||r(this,b).isStale||!ue(e))return;const a=we(r(this,b).dataUpdatedAt,e)+1;d(this,F,setTimeout(()=>{r(this,b).isStale||this.updateResult()},a))},X=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,n)):this.options.refetchInterval)??!1},Y=function(e){p(this,o,te).call(this),d(this,E,e),!(he||N(this.options.enabled,r(this,n))===!1||!ue(r(this,E))||r(this,E)===0)&&d(this,I,setInterval(()=>{(this.options.refetchIntervalInBackground||Ce.isFocused())&&p(this,o,A).call(this)},r(this,E)))},Z=function(){p(this,o,J).call(this),p(this,o,Y).call(this,p(this,o,X).call(this))},ee=function(){r(this,F)&&(clearTimeout(r(this,F)),d(this,F,void 0))},te=function(){r(this,I)&&(clearInterval(r(this,I)),d(this,I,void 0))},se=function(){const e=r(this,y).getQueryCache().build(r(this,y),this.options);if(e===r(this,n))return;const s=r(this,n);d(this,n,e),d(this,L,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},be=function(e){ge.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,b))}),r(this,y).getQueryCache().notify({query:r(this,n),type:"observerResultsUpdated"})})},xe);function ke(t,e){return N(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function me(t,e){return ke(t,e)||t.state.data!==void 0&&re(t,e,e.refetchOnMount)}function re(t,e,s){if(N(e.enabled,t)!==!1){const a=typeof s=="function"?s(t):s;return a==="always"||a!==!1&&ie(t,e)}return!1}function pe(t,e,s,a){return(t!==e||N(a.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&ie(t,s)}function ie(t,e){return N(e.enabled,t)!==!1&&t.isStaleByTime(_(e.staleTime,t))}function He(t,e){return!W(t.getCurrentResult(),e)}var ye=j.createContext(!1),Ve=()=>j.useContext(ye);ye.Provider;function $e(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var ze=j.createContext($e()),Ke=()=>j.useContext(ze),We=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},qe=t=>{j.useEffect(()=>{t.clearReset()},[t])},Ge=({result:t,errorResetBoundary:e,throwOnError:s,query:a})=>t.isError&&!e.isReset()&&!t.isFetching&&a&&Ee(s,[t.error,a]),Je=t=>{t.suspense&&(typeof t.staleTime!="number"&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},Xe=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Ye=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Ze(t,e,s){var x,w,u,U;const a=Se(),c=Ve(),h=Ke(),l=a.defaultQueryOptions(t);(w=(x=a.getDefaultOptions().queries)==null?void 0:x._experimental_beforeQuery)==null||w.call(x,l),l._optimisticResults=c?"isRestoring":"optimistic",Je(l),We(l,h),qe(h);const[f]=j.useState(()=>new e(a,l)),m=f.getOptimisticResult(l);if(j.useSyncExternalStore(j.useCallback(v=>{const B=c?()=>{}:f.subscribe(ge.batchCalls(v));return f.updateResult(),B},[f,c]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),j.useEffect(()=>{f.setOptions(l,{listeners:!1})},[l,f]),Xe(l,m))throw Ye(l,f,h);if(Ge({result:m,errorResetBoundary:h,throwOnError:l.throwOnError,query:a.getQueryCache().get(l.queryHash)}))throw m.error;return(U=(u=a.getDefaultOptions().queries)==null?void 0:u._experimental_afterQuery)==null||U.call(u,l,m),l.notifyOnChangeProps?m:f.trackResult(m)}function et(t,e){return Ze(t,_e)}async function tt(){try{const t=await q.get(G);if((t==null?void 0:t.status)===200&&(t!=null&&t.data))return t.data;throw new Error("Unexpected API response")}catch(t){throw console.error(`Error fetching roles: ${t.message||t}`),new Error("Failed to fetch roles. Please try again later.")}}async function st(t){try{let e;if(t.id){const s=G+"/"+t.id;e=await q.put(s,t)}else e=await q.post(G,t);if((e==null?void 0:e.status)===200&&(e!=null&&e.data))return e.data;throw new Error("Unexpected API response")}catch(e){throw console.error(`Error fetching roles: ${e.message||e}`),new Error("Failed to fetch roles. Please try again later.")}}const rt=Oe().shape({name:Fe().required("Role name is required.")}),it=({onClose:t,role:e})=>{const{register:s,handleSubmit:a,formState:{errors:c},setValue:h}=Ie({resolver:De(rt),defaultValues:{name:(e==null?void 0:e.name)||""}});j.useEffect(()=>{e&&h("name",e.name)},[e,h]);const{mutate:l,isLoading:f}=Qe({mutationFn:m=>st({...m,id:e==null?void 0:e.id}),onSuccess:m=>{t&&t(!0),fe.success(m.message)},onError:m=>{const{response:x}=m;fe.error(x.data.message)}});return i.jsxs("form",{className:"flex flex-col gap-5 min-w-96",onSubmit:a(m=>l(m)),children:[i.jsx("div",{className:"px-2 grid grid-cols-1",children:i.jsxs("div",{className:"col-span-1 md:col-span-3 lg:col-span-6",children:[i.jsx(k,{variant:"body2",children:"Name"}),i.jsx(Pe,{size:"small",placeholder:"Name",...s("name"),name:"name",error:!!(c!=null&&c.name),errorText:!!c.name&&c.name.message})]})}),i.jsxs("div",{className:"inline-flex gap-2 justify-end",children:[i.jsx("button",{className:"px-3 py-1 border border-gray-500 text-gray-600 rounded-md",type:"reset",onClick:()=>{t&&t()},children:"Close"}),i.jsx("button",{type:"submit",className:"px-3 py-1 text-white rounded-md bg-teal-700 focus:bg-teal-900 outline-none",disabled:f,children:"Save & Next"})]})]})},lt=()=>{const[t,e]=j.useState(!1),[s,a]=j.useState(null),{data:c,isLoading:h,refetch:l}=et({queryKey:["roles"],queryFn:tt}),f=(x=!1)=>{e(!1),a(null),x&&l()},m=x=>{a(x),e(!0)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex flex-col gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"flex items-center gap-2",children:i.jsx("span",{className:"font-semibold",children:"Doctors"})}),i.jsx("small",{className:"text-xs font-normal text-gray-500",children:"Dashboard > Doctors"})]}),i.jsxs("div",{className:"bg-white grid grid-cols-1 gap-3 p-2 rounded-lg",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-center",children:[i.jsxs("div",{className:"flex-1 inline-flex w-full justify-between items-center",children:[i.jsx(k,{variant:"body1",className:"font-medium truncate",children:"Doctors List"}),i.jsxs("div",{className:"rounded-md border p-2 font-medium inline-flex gap-1 items-center",onClick:()=>e(!0),children:[i.jsx(Te,{className:"text-gray-500"}),i.jsx("span",{className:"text-sm font-medium text-gray-500 cursor-pointer",children:"Add"})]})]}),i.jsxs("div",{className:"inline-flex w-full sm:w-auto items-center gap-2",children:[i.jsxs("button",{className:"p-2.5 sm:p-2 md:w-auto rounded-md border inline-flex gap-1 items-center",children:[i.jsx(Ue,{className:"text-gray-500"}),i.jsx("span",{className:"hidden sm:block text-sm font-medium text-gray-500 cursor-pointer",children:"Filter"})]}),i.jsx("input",{type:"search",className:"border rounded-md p-2 outline-none text-sm w-full sm:w-52",placeholder:"Search"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full bg-white border-gray-300",children:[i.jsx("thead",{className:"text-sm font-normal w-full bg-gray-200",children:i.jsxs("tr",{className:"text-left",children:[i.jsx("th",{className:"p-2 font-semibold",children:"Name"}),i.jsx("th",{className:"p-2 font-semibold text-center",children:"Status"}),i.jsx("th",{className:"p-2 font-semibold text-right",children:"Action"})]})}),i.jsx("tbody",{children:c==null?void 0:c.data.map((x,w)=>i.jsxs("tr",{className:"bg-white hover:bg-gray-100 rounded-md ",children:[i.jsx("td",{className:"p-2 truncate",children:i.jsx(k,{variant:"body2",children:x.name})}),i.jsx("td",{className:"p-2 text-center",children:i.jsx(k,{component:"span",variant:"caption",className:"bg-green-500 text-white px-1.5 py-0.5 rounded-lg",children:"Activate"})}),i.jsx("td",{className:"p-2 ",children:i.jsxs("div",{className:"inline-flex items-center gap-2 float-end h-full",children:[i.jsx("div",{className:"text-slate-900 cursor-pointer",onClick:()=>m(x),children:i.jsx(Ae,{})}),i.jsx("button",{className:"text-red-800 cursor-pointer",children:i.jsx(Le,{})})]})})]},w))})]})}),i.jsx("hr",{}),i.jsx(Me,{})]})]}),i.jsx(Be,{open:t,onClose:()=>e(!1),title:s?`Edit ${s.name} Role`:"Add Role",children:i.jsx(it,{onClose:f,role:s})})]})};export{lt as default};
